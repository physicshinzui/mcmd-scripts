
        subroutine cal_denomi

c  Calculate denominator for the current c. mat.
c******************************************************
        include "COMDAT"
c******************************************************
        do mm=1,mvert
          do ii=1,nwin
          cpdf(ii,mm)=0.0

          do jj=1,nwin
            cpdf(ii,mm)=cpdf(ii,mm)+cmat(jj,ii,mm)
          enddo
        enddo
        enddo

c  Check.
        do mm=1,mvert
        do ii=1,nwin
          if(cpdf(ii,mm).lt.0.0) then
            print*,' ???????????????????????????????'
            print*,' ? Negative prob. is detected. ?'
            print*,' ???????????????????????????????'
            stop
          endif

          do jj=1,nwin
            if(cmat(jj,ii,mm).lt.0.0) then
              print*,'?????????????????????????????'
              print*,' ? Negative count detected. ?'
              print*,'?????????????????????????????'
              stop
            endif
          enddo
        enddo
        enddo
c******************************************************
        return
        end
